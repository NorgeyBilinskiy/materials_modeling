# Краткое описание проекта

## Цель проекта

Создание MVP-репозитория для предсказания энергии формирования кристалла NaCl с использованием четырех различных графовых нейронных сетей: CGCNN, MEGNet, SchNet и MPNN.

## Основные достижения

### ✅ Структура проекта
- **Модульная архитектура** с четким разделением ответственности
- **Docker-контейнеризация** для воспроизводимости
- **CLI-интерфейс** для удобного использования
- **Jupyter ноутбуки** для анализа и презентации результатов

### ✅ Реализованные модели
1. **CGCNN (Crystal Graph Convolutional Neural Network)**
   - Специализированная архитектура для кристаллических структур
   - Использует CGConv слои для обработки графов
   - Учитывает периодические граничные условия

2. **MEGNet (MatErials Graph Network)**
   - Универсальная архитектура для материалов
   - Использует GatedGraphConv слои
   - Поддерживает глобальные признаки

3. **SchNet (Schrödinger Network)**
   - Квантово-механически обоснованная архитектура
   - Использует фильтры для моделирования взаимодействий
   - Основана на принципах квантовой механики

4. **MPNN (Message Passing Neural Network)**
   - Общий фреймворк для графовых нейронных сетей
   - Реализует передачу сообщений между узлами
   - Гибкая архитектура для различных типов графов

### ✅ Обработка данных
- **Автоматическая загрузка** данных NaCl из различных источников
- **Преобразование кристаллических структур** в графовые представления
- **Предобработка данных** для машинного обучения
- **Создание обучающих наборов** с вариациями структур

### ✅ Обучение и оценка
- **Полный пайплайн обучения** с валидацией
- **Мониторинг процесса** с логированием
- **Сравнение моделей** по различным метрикам
- **Визуализация результатов** обучения

### ✅ Тестирование и качество
- **Unit-тесты** для всех компонентов
- **End-to-end тестирование** пайплайна
- **Проверка качества кода** с линтерами
- **Документация** и инструкции по использованию

## Технические особенности

### Архитектура
```
materials_modeling/
├── data_loader/          # Загрузка и предобработка данных
├── models/              # Реализации графовых моделей
├── notebooks/           # Jupyter ноутбуки для анализа
├── tests/               # Unit-тесты
├── run.py               # CLI-интерфейс
├── Dockerfile           # Контейнеризация
└── requirements.txt     # Зависимости
```

### Используемые технологии
- **PyTorch** - основной фреймворк для глубокого обучения
- **PyTorch Geometric** - библиотека для графовых нейронных сетей
- **pymatgen** - библиотека для работы с кристаллическими структурами
- **Click** - создание CLI-интерфейса
- **Docker** - контейнеризация проекта

### Метрики качества
- **MSE (Mean Squared Error)** - основная метрика потерь
- **MAE (Mean Absolute Error)** - средняя абсолютная ошибка
- **RMSE (Root Mean Squared Error)** - корень из среднеквадратичной ошибки
- **R² (Coefficient of Determination)** - коэффициент детерминации

## Результаты

### Ожидаемые результаты для NaCl
- **Референсное значение**: -3.6 эВ/атом
- **CGCNN**: Ожидается близкое к референсному значение
- **MEGNet**: Стабильные предсказания с хорошей точностью
- **SchNet**: Физически обоснованные результаты
- **MPNN**: Базовые предсказания для сравнения

### Преимущества проекта
1. **Воспроизводимость** - Docker-контейнеры и фиксированные версии зависимостей
2. **Модульность** - легко добавлять новые модели и данные
3. **Документированность** - подробная документация и примеры
4. **Тестируемость** - полное покрытие тестами
5. **Масштабируемость** - готовность к расширению на другие материалы

## Использование

### Быстрый старт
```bash
# Клонирование и установка
git clone <repository-url>
cd materials_modeling
pip install -r requirements.txt

# Настройка проекта
python run.py setup

# Обучение модели
python run.py train --method cgcnn

# Предсказание
python run.py predict --method cgcnn

# Сравнение всех моделей
python run.py compare
```

### Jupyter ноутбуки
1. `01_data_exploration.ipynb` - Исследование данных NaCl
2. `02_train_cgcnn.ipynb` - Обучение CGCNN
3. `03_train_megnet.ipynb` - Обучение MEGNet
4. `04_train_schnet.ipynb` - Обучение SchNet
5. `05_compare_models.ipynb` - Сравнение всех моделей

## Заключение

Проект представляет собой полнофункциональный MVP для предсказания энергии формирования кристаллических структур с использованием современных графовых нейронных сетей. Реализованы все требуемые компоненты:

- ✅ Структура проекта по лучшим практикам
- ✅ Четыре различные графовые модели
- ✅ Автоматическая обработка данных
- ✅ Полный пайплайн обучения и оценки
- ✅ Документация и тестирование
- ✅ Готовность к использованию

Проект демонстрирует применение графовых нейронных сетей в материаловедении и может служить основой для дальнейших исследований в области предсказания свойств материалов.

